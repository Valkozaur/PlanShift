$(document).ready(function(){function t(n){$("#calender").fullCalendar("destroy");$("#calender").fullCalendar({contentHeight:420,defaultDate:new Date,timeFormat:"HH:mm",header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},eventLimit:!0,eventColor:"#378006",events:n,eventClick:function(n){$("#myModal #groupName").text(n.groupName);var t=$("<div />");t.append($("<p />").html("<b>Start:<\/b> "+n.start.format("DD-MMM-YYYY HH:mm a")));n.end!=null&&t.append($("<p/>").html("<b>End:<\/b> "+n.end.format("DD-MMM-YYYY HH:mm a")));t.append($("<p />").html("<b>Description:<\/b>"+n.description));$("#myModal #pDetails").empty().html(t);$("#myModal #shiftId").val(n.id);i(n.type);$("#myModal").modal()}})}function i(n){n==2?($("#shiftActionForm").attr("action","/ShiftApplication/Apply"),$("#shiftActionForm > button").text("Apply")):n==3&&($("#shiftActionForm").attr("action","/ShiftChange/Approve"),$("#shiftActionForm > button").text("Accept"))}var n=[];$.ajax({type:"GET",url:"/api/Calendar?businessId=@Model.BusinessId",success:function(i){i.upcomingShiftsCount!=0&&($("#upcomingShiftsCount").text(i.upcomingShiftsCount),$("#upcomingShiftsCount").css("color","#00bfff"));i.openShiftsCount!=0&&$("#openShiftsCount").text(i.openShiftsCount).css("color","#FF0000");i.pendingShiftsCount!=0&&$("#pendingShiftsCount").text(i.pendingShiftsCount).css("color","#9932cc");$.each(i.allShiftsCalendar,function(t,i){var r=null;i.type==1?r="#00bfff":i.type==2?r="#FF0000":i.type==3&&(r="#9932cc");n.push({id:i.id,type:i.type,groupName:i.groupName,description:i.description,start:moment(i.start),end:i.end!=null?moment(i.end):null,color:r,allDay:!1,eventDisplay:"auto"})});t(n)},error:function(){alert("failed")}})});